{% extends "template.html" %}
{% block content %}

<!-- a simple form that just has a url input and a submit button -->
<!-- centered with boostrap -->
<div class="container align-items-center" id="main-form">
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-body">
                    <form action="/" method="post" onload="data => {console.log(data)}" onerror="data => {console.log(data)}">
                        <div class="mb-3">
                            <label for="url" class="form-label">URL<i style="color: red">*</i></label>
                            {% if error %}
                                <input type="text" class="form-control is-invalid" id="url" name="url" aria-describedby="urlHelp" value="{{ url }}" required>
                                <div class="invalid-feedback">
                                    {{ error }}
                                </div>
                            {% else %}
                            	<input type="text" class="form-control" id="url" name="url" aria-describedby="urlHelp" required>
                            {% endif %}
                            <div id="urlHelp" class="form-text">Required - This will be the url that the QR code links to</div>
                        </div>
                        <div class="mb-3">
                            <label for="key" class="form-label">Key</label>
                            <input type="text" class="form-control" id="key" name="key" aria-describedby="keyHelp">
                            <div id="keyHelp" class="form-text">Optional - This will produce a link that ends with /&#60;key&#62;</div>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="password" name="password" aria-describedby="passwordHelp">
                            <div id="passwordHelp" class="form-text">Optional - The password will be required to view the QR code stats</div>
                        </div>
                        
                        <hr class="my-4">
                        <h5 class="mb-3">QR Code Styling</h5>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="qr_style_width" class="form-label">Width</label>
                                <input type="number" class="form-control" id="qr_style_width" name="qr_style_width" value="{{ qr_config.width | default(512) }}" min="100" max="2000">
                            </div>
                            <div class="col-md-6">
                                <label for="qr_style_height" class="form-label">Height</label>
                                <input type="number" class="form-control" id="qr_style_height" name="qr_style_height" value="{{ qr_config.height | default(512) }}" min="100" max="2000">
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="qr_style_color_dark" class="form-label">Dark Color</label>
                                <input type="color" class="form-control form-control-color" id="qr_style_color_dark" name="qr_style_color_dark" value="{{ qr_config.color_dark | default('#000000') }}" title="Choose dark color">
                            </div>
                            <div class="col-md-6">
                                <label for="qr_style_color_light" class="form-label">Light Color</label>
                                <input type="color" class="form-control form-control-color" id="qr_style_color_light" name="qr_style_color_light" value="{{ qr_config.color_light | default('#ffffff') }}" title="Choose light color">
                            </div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="qr_style_dot_type" class="form-label">Dot Style</label>
                                <select class="form-select" id="qr_style_dot_type" name="qr_style_dot_type">
                                    <option value="square" {% if (qr_config.dot_type | default('square')) == 'square' %}selected{% endif %}>Square</option>
                                    <option value="rounded" {% if (qr_config.dot_type | default('square')) == 'rounded' %}selected{% endif %}>Rounded</option>
                                    <option value="extra-rounded" {% if (qr_config.dot_type | default('square')) == 'extra-rounded' %}selected{% endif %}>Extra Rounded</option>
                                    <option value="classy" {% if (qr_config.dot_type | default('square')) == 'classy' %}selected{% endif %}>Classy</option>
                                    <option value="classy-rounded" {% if (qr_config.dot_type | default('square')) == 'classy-rounded' %}selected{% endif %}>Classy Rounded</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="qr_style_margin" class="form-label">Margin</label>
                                <input type="number" class="form-control" id="qr_style_margin" name="qr_style_margin" value="{{ qr_config.margin | default(4) }}" min="0" max="20">
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#advancedStyling" aria-expanded="false" aria-controls="advancedStyling">
                                Advanced Options <i class="bi bi-chevron-down"></i>
                            </button>
                        </div>
                        
                        <div class="collapse" id="advancedStyling">
                            <div class="card card-body mb-3">
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="qr_style_corner_square_type" class="form-label">Corner Square Style</label>
                                        <select class="form-select" id="qr_style_corner_square_type" name="qr_style_corner_square_type">
                                            <option value="none" {% if (qr_config.corner_square_type | default('square')) == 'none' %}selected{% endif %}>None</option>
                                            <option value="square" {% if (qr_config.corner_square_type | default('square')) == 'square' %}selected{% endif %}>Square</option>
                                            <option value="dot" {% if (qr_config.corner_square_type | default('square')) == 'dot' %}selected{% endif %}>Dot</option>
                                            <option value="extra-rounded" {% if (qr_config.corner_square_type | default('square')) == 'extra-rounded' %}selected{% endif %}>Extra Rounded</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="qr_style_corner_dot_type" class="form-label">Corner Dot Style</label>
                                        <select class="form-select" id="qr_style_corner_dot_type" name="qr_style_corner_dot_type">
                                            <option value="none" {% if (qr_config.corner_dot_type | default('square')) == 'none' %}selected{% endif %}>None</option>
                                            <option value="square" {% if (qr_config.corner_dot_type | default('square')) == 'square' %}selected{% endif %}>Square</option>
                                            <option value="dot" {% if (qr_config.corner_dot_type | default('square')) == 'dot' %}selected{% endif %}>Dot</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label for="qr_style_correct_level" class="form-label">Error Correction Level</label>
                                    <select class="form-select" id="qr_style_correct_level" name="qr_style_correct_level">
                                        <option value="L" {% if (qr_config.correct_level | default('H')) == 'L' %}selected{% endif %}>L - Low (~7% recovery)</option>
                                        <option value="M" {% if (qr_config.correct_level | default('H')) == 'M' %}selected{% endif %}>M - Medium (~15% recovery)</option>
                                        <option value="Q" {% if (qr_config.correct_level | default('H')) == 'Q' %}selected{% endif %}>Q - Quartile (~25% recovery)</option>
                                        <option value="H" {% if (qr_config.correct_level | default('H')) == 'H' %}selected{% endif %}>H - High (~30% recovery)</option>
                                    </select>
                                </div>
                                
                                <hr>
                                <h6>Logo Options</h6>
                                <div class="mb-3">
                                    <label for="qr_style_logo_image" class="form-label">Logo Image URL</label>
                                    <input type="url" class="form-control" id="qr_style_logo_image" name="qr_style_logo_image" value="{{ qr_config.logo_image | default('') }}" placeholder="https://example.com/logo.png">
                                    <div class="form-text">Optional - URL to an image to embed in the center of the QR code</div>
                                </div>
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="qr_style_logo_size" class="form-label">Logo Size</label>
                                        <input type="number" class="form-control" id="qr_style_logo_size" name="qr_style_logo_size" value="{{ qr_config.logo_size | default(0.3) }}" step="0.1" min="0.1" max="0.5">
                                        <div class="form-text">Size relative to QR code (0.1-0.5)</div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="qr_style_logo_margin" class="form-label">Logo Margin</label>
                                        <input type="number" class="form-control" id="qr_style_logo_margin" name="qr_style_logo_margin" value="{{ qr_config.logo_margin | default(3) }}" min="0" max="10">
                                    </div>
                                </div>
                                
                                <hr>
                                <h6>Gradient Options</h6>
                                <div class="mb-3">
                                    <label for="qr_style_gradient_type" class="form-label">Gradient Type</label>
                                    <select class="form-select" id="qr_style_gradient_type" name="qr_style_gradient_type">
                                        <option value="">None (Solid Color)</option>
                                        <option value="linear" {% if (qr_config.gradient_type | default('')) == 'linear' %}selected{% endif %}>Linear</option>
                                        <option value="radial" {% if (qr_config.gradient_type | default('')) == 'radial' %}selected{% endif %}>Radial</option>
                                    </select>
                                </div>
                                <div class="row mb-3" id="gradientOptions" style="display: none;">
                                    <div class="col-md-4">
                                        <label for="qr_style_gradient_color_start" class="form-label">Start Color</label>
                                        <input type="color" class="form-control form-control-color" id="qr_style_gradient_color_start" name="qr_style_gradient_color_start" value="{{ qr_config.gradient_color_start | default('#000000') }}" title="Choose gradient start color">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="qr_style_gradient_color_end" class="form-label">End Color</label>
                                        <input type="color" class="form-control form-control-color" id="qr_style_gradient_color_end" name="qr_style_gradient_color_end" value="{{ qr_config.gradient_color_end | default('#000000') }}" title="Choose gradient end color">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="qr_style_gradient_rotation" class="form-label">Rotation (degrees)</label>
                                        <input type="number" class="form-control" id="qr_style_gradient_rotation" name="qr_style_gradient_rotation" value="{{ qr_config.gradient_rotation | default(0) }}" min="0" max="360">
                                    </div>
                                </div>
                                
                                <hr>
                                <h6>Background Gradient Options</h6>
                                <div class="mb-3">
                                    <label for="qr_style_background_gradient_type" class="form-label">Background Gradient Type</label>
                                    <select class="form-select" id="qr_style_background_gradient_type" name="qr_style_background_gradient_type">
                                        <option value="">None (Solid Color)</option>
                                        <option value="linear" {% if (qr_config.background_gradient_type | default('')) == 'linear' %}selected{% endif %}>Linear</option>
                                        <option value="radial" {% if (qr_config.background_gradient_type | default('')) == 'radial' %}selected{% endif %}>Radial</option>
                                    </select>
                                </div>
                                <div class="row mb-3" id="backgroundGradientOptions" style="display: none;">
                                    <div class="col-md-4">
                                        <label for="qr_style_background_gradient_color_start" class="form-label">Start Color</label>
                                        <input type="color" class="form-control form-control-color" id="qr_style_background_gradient_color_start" name="qr_style_background_gradient_color_start" value="{{ qr_config.background_gradient_color_start | default('#ffffff') }}" title="Choose background gradient start color">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="qr_style_background_gradient_color_end" class="form-label">End Color</label>
                                        <input type="color" class="form-control form-control-color" id="qr_style_background_gradient_color_end" name="qr_style_background_gradient_color_end" value="{{ qr_config.background_gradient_color_end | default('#ffffff') }}" title="Choose background gradient end color">
                                    </div>
                                    <div class="col-md-4">
                                        <label for="qr_style_background_gradient_rotation" class="form-label">Rotation (degrees)</label>
                                        <input type="number" class="form-control" id="qr_style_background_gradient_rotation" name="qr_style_background_gradient_rotation" value="{{ qr_config.background_gradient_rotation | default(0) }}" min="0" max="360">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary">Get QR code</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Show/hide gradient options based on selection
document.getElementById('qr_style_gradient_type').addEventListener('change', function() {
    const gradientOptions = document.getElementById('gradientOptions');
    if (this.value) {
        gradientOptions.style.display = 'flex';
    } else {
        gradientOptions.style.display = 'none';
    }
});

document.getElementById('qr_style_background_gradient_type').addEventListener('change', function() {
    const backgroundGradientOptions = document.getElementById('backgroundGradientOptions');
    if (this.value) {
        backgroundGradientOptions.style.display = 'flex';
    } else {
        backgroundGradientOptions.style.display = 'none';
    }
});

// Initialize visibility on page load
if (document.getElementById('qr_style_gradient_type').value) {
    document.getElementById('gradientOptions').style.display = 'flex';
}
if (document.getElementById('qr_style_background_gradient_type').value) {
    document.getElementById('backgroundGradientOptions').style.display = 'flex';
}
</script>

{% endblock %}
